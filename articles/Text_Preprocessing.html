<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Text Preprocessing and Entity Extraction • LBDiscover</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Text Preprocessing and Entity Extraction">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">LBDiscover</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Intro_to_Literature-Based_Discovery.html">Getting Started with Literature-Based Discovery</a></li>
    <li><a class="dropdown-item" href="../articles/Text_Preprocessing.html">Text Preprocessing and Entity Extraction</a></li>
    <li><a class="dropdown-item" href="../articles/Work_with_Discovery_Models.html">Working with Discovery Models</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/chaoliu-cl/LBDiscover/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Text Preprocessing and Entity Extraction</h1>
                        <h4 data-toc-skip class="author">Chao Liu</h4>
            
            <h4 data-toc-skip class="date">2025-05-15</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/chaoliu-cl/LBDiscover/blob/main/vignettes/Text_Preprocessing.Rmd" class="external-link"><code>vignettes/Text_Preprocessing.Rmd</code></a></small>
      <div class="d-none name"><code>Text_Preprocessing.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="text-preprocessing-and-entity-extraction">Text Preprocessing and Entity Extraction<a class="anchor" aria-label="anchor" href="#text-preprocessing-and-entity-extraction"></a>
</h2>
<p>This vignette explains the text preprocessing and entity extraction
capabilities of the <code>LBDiscover</code> package, which are
fundamental steps in the literature-based discovery process.</p>
<div class="section level3">
<h3 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h3>
<p>Before applying discovery models, we need to preprocess the text data
and extract the entities of interest. These steps transform raw text
into structured information that can be used for discovering
relationships between biomedical concepts.</p>
</div>
<div class="section level3">
<h3 id="loading-the-package">Loading the Package<a class="anchor" aria-label="anchor" href="#loading-the-package"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/chaoliu-cl/LBDiscover" class="external-link">LBDiscover</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading LBDiscover package</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="data-retrieval">Data Retrieval<a class="anchor" aria-label="anchor" href="#data-retrieval"></a>
</h3>
<p>First, let’s retrieve some sample articles:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Search for articles about migraines</span></span>
<span><span class="va">migraine_articles</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pubmed_search.html">pubmed_search</a></span><span class="op">(</span></span>
<span>  query <span class="op">=</span> <span class="st">"migraine pathophysiology"</span>,</span>
<span>  max_results <span class="op">=</span> <span class="fl">100</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Created pubmed_cache environment for result caching</span></span>
<span><span class="co">#&gt; Searching PubMed for: migraine pathophysiology</span></span>
<span><span class="co">#&gt; Found 11643 results, retrieving 100 records</span></span>
<span><span class="co">#&gt; Fetching batch 1 of 1 (records 1-100)</span></span>
<span><span class="co">#&gt; Processing 100 articles</span></span>
<span><span class="co">#&gt;   Processing article 100 of 100</span></span>
<span><span class="co">#&gt; Cached search results for future use</span></span>
<span></span>
<span><span class="co"># View the first article</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">migraine_articles</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pmid"</span>, <span class="st">"title"</span><span class="op">)</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt;       pmid</span></span>
<span><span class="co">#&gt; 1 40371864</span></span>
<span><span class="co">#&gt; 2 40357069</span></span>
<span><span class="co">#&gt; 3 40354987</span></span>
<span><span class="co">#&gt;                                                                                                                         title</span></span>
<span><span class="co">#&gt; 1 [Morning headaches in patients with obstructive sleep apnea syndrome: Pathogenesis, differential diagnosis, and treatment].</span></span>
<span><span class="co">#&gt; 2             Third Occipital Nerve Block and Cooled Radiofrequency Ablation for Managing Hemicrania Continua: A Case Report.</span></span>
<span><span class="co">#&gt; 3                     Hypothalamic connectivity strength is decreasing with polygenic risk in migraine without aura patients.</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="basic-text-preprocessing">Basic Text Preprocessing<a class="anchor" aria-label="anchor" href="#basic-text-preprocessing"></a>
</h3>
<p>The first step is to preprocess the text data to extract meaningful
terms:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Preprocess the abstracts</span></span>
<span><span class="va">preprocessed_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/preprocess_text.html">preprocess_text</a></span><span class="op">(</span></span>
<span>  <span class="va">migraine_articles</span>,</span>
<span>  text_column <span class="op">=</span> <span class="st">"abstract"</span>,</span>
<span>  remove_stopwords <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  custom_stopwords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"study"</span>, <span class="st">"patient"</span>, <span class="st">"result"</span>, <span class="st">"conclusion"</span><span class="op">)</span>,</span>
<span>  min_word_length <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  max_word_length <span class="op">=</span> <span class="fl">25</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Tokenizing text...</span></span>
<span></span>
<span><span class="co"># View terms extracted from the first document</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">preprocessed_data</span><span class="op">$</span><span class="va">terms</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt;          word count</span></span>
<span><span class="co">#&gt; 1   abdominal     1</span></span>
<span><span class="co">#&gt; 2   addressed     1</span></span>
<span><span class="co">#&gt; 3      airway     1</span></span>
<span><span class="co">#&gt; 4       algic     1</span></span>
<span><span class="co">#&gt; 5       among     1</span></span>
<span><span class="co">#&gt; 6  anatomical     1</span></span>
<span><span class="co">#&gt; 7       apnea     3</span></span>
<span><span class="co">#&gt; 8  associated     6</span></span>
<span><span class="co">#&gt; 9   attention     1</span></span>
<span><span class="co">#&gt; 10       back     1</span></span></code></pre></div>
<div class="section level4">
<h4 id="optimized-preprocessing-for-large-datasets">Optimized Preprocessing for Large Datasets<a class="anchor" aria-label="anchor" href="#optimized-preprocessing-for-large-datasets"></a>
</h4>
<p>For larger datasets, we can use the optimized vectorized
preprocessing function:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Use optimized vectorized preprocessing</span></span>
<span><span class="va">opt_preprocessed_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/vec_preprocess.html">vec_preprocess</a></span><span class="op">(</span></span>
<span>  <span class="va">migraine_articles</span>,</span>
<span>  text_column <span class="op">=</span> <span class="st">"abstract"</span>,</span>
<span>  remove_stopwords <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  min_word_length <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  chunk_size <span class="op">=</span> <span class="fl">50</span>  <span class="co"># Process in chunks of 50 documents</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Processing text in 2 chunks...</span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |===================================                                   |  50%  |                                                                              |======================================================================| 100%</span></span>
<span></span>
<span><span class="co"># Compare processing times</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/preprocess_text.html">preprocess_text</a></span><span class="op">(</span></span>
<span>    <span class="va">migraine_articles</span>,</span>
<span>    text_column <span class="op">=</span> <span class="st">"abstract"</span>,</span>
<span>    remove_stopwords <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co">#&gt; Tokenizing text...</span></span>
<span><span class="co">#&gt;    user  system elapsed </span></span>
<span><span class="co">#&gt;   0.069   0.000   0.069</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/vec_preprocess.html">vec_preprocess</a></span><span class="op">(</span></span>
<span>    <span class="va">migraine_articles</span>,</span>
<span>    text_column <span class="op">=</span> <span class="st">"abstract"</span>,</span>
<span>    remove_stopwords <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    chunk_size <span class="op">=</span> <span class="fl">50</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co">#&gt; Processing text in 2 chunks...</span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |===================================                                   |  50%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt;    user  system elapsed </span></span>
<span><span class="co">#&gt;   0.064   0.000   0.064</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="advanced-text-analysis">Advanced Text Analysis<a class="anchor" aria-label="anchor" href="#advanced-text-analysis"></a>
</h3>
<div class="section level4">
<h4 id="n-gram-extraction">N-gram Extraction<a class="anchor" aria-label="anchor" href="#n-gram-extraction"></a>
</h4>
<p>We can extract n-grams (sequences of n words) to capture multi-word
concepts:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract bigrams (2-word sequences)</span></span>
<span><span class="va">bigrams</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_ngrams.html">extract_ngrams</a></span><span class="op">(</span></span>
<span>  <span class="va">migraine_articles</span><span class="op">$</span><span class="va">abstract</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  min_freq <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View the most frequent bigrams</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">bigrams</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt;                 ngram frequency</span></span>
<span><span class="co">#&gt; 7529           in the       161</span></span>
<span><span class="co">#&gt; 10138     of migraine        79</span></span>
<span><span class="co">#&gt; 10239          of the        79</span></span>
<span><span class="co">#&gt; 10631             p 0        79</span></span>
<span><span class="co">#&gt; 10987   patients with        68</span></span>
<span><span class="co">#&gt; 16211   with migraine        58</span></span>
<span><span class="co">#&gt; 7452      in migraine        51</span></span>
<span><span class="co">#&gt; 2828  associated with        48</span></span>
<span><span class="co">#&gt; 14627      this study        47</span></span>
<span><span class="co">#&gt; 14908          to the        44</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="sentence-segmentation">Sentence Segmentation<a class="anchor" aria-label="anchor" href="#sentence-segmentation"></a>
</h4>
<p>Segmenting text into sentences can be useful for more granular
analysis:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract sentences from the first abstract</span></span>
<span><span class="va">abstracts</span> <span class="op">&lt;-</span> <span class="va">migraine_articles</span><span class="op">$</span><span class="va">abstract</span></span>
<span><span class="va">first_abstract</span> <span class="op">&lt;-</span> <span class="va">abstracts</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Make sure we have a valid abstract</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">first_abstract</span><span class="op">)</span> <span class="op">||</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">first_abstract</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">||</span> <span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar</a></span><span class="op">(</span><span class="va">first_abstract</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Find the first non-empty abstract</span></span>
<span>  <span class="va">valid_idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">abstracts</span><span class="op">)</span> <span class="op">&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar</a></span><span class="op">(</span><span class="va">abstracts</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">valid_idx</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">first_abstract</span> <span class="op">&lt;-</span> <span class="va">abstracts</span><span class="op">[</span><span class="va">valid_idx</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"First abstract was empty, using abstract #"</span>, <span class="va">valid_idx</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="st">"instead.\n"</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="co"># Create a sample abstract for demonstration</span></span>
<span>    <span class="va">first_abstract</span> <span class="op">&lt;-</span> <span class="st">"This is a sample abstract for demonstration. It contains multiple sentences. Each sentence will be extracted separately."</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"No valid abstracts found. Using a sample abstract for demonstration.\n"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Now segment the valid abstract</span></span>
<span><span class="va">sentences</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/segment_sentences.html">segment_sentences</a></span><span class="op">(</span><span class="va">first_abstract</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check if sentences list has elements before trying to access them</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">sentences</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span> <span class="op">&amp;&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">sentences</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># View the first few sentences</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sentences</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">sentences</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"No sentences could be extracted. The abstract might be too short or formatted incorrectly.\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; [1] "Sleep disorders are often associated with painful ones, especially in patients with chronic syndromes."                                     </span></span>
<span><span class="co">#&gt; [2] "Cephalgia occupies an important place among such algic forms as fibromyalgia, back pain, and abdominal and joint pain."                     </span></span>
<span><span class="co">#&gt; [3] "Headaches and sleep disturbances may be independent, deri.e. from a single pathogenetic factor, or their relationship may be bidi.e.tional."</span></span>
<span></span>
<span><span class="co"># View the first few sentences</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sentences</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Sleep disorders are often associated with painful ones, especially in patients with chronic syndromes."                                     </span></span>
<span><span class="co">#&gt; [2] "Cephalgia occupies an important place among such algic forms as fibromyalgia, back pain, and abdominal and joint pain."                     </span></span>
<span><span class="co">#&gt; [3] "Headaches and sleep disturbances may be independent, deri.e. from a single pathogenetic factor, or their relationship may be bidi.e.tional."</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="language-detection">Language Detection<a class="anchor" aria-label="anchor" href="#language-detection"></a>
</h4>
<p>For dealing with multilingual corpora, we can detect the language of
each document:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Filter out NA values from abstracts and detect language</span></span>
<span><span class="va">abstracts</span> <span class="op">&lt;-</span> <span class="va">migraine_articles</span><span class="op">$</span><span class="va">abstract</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span>
<span><span class="va">valid_abstracts</span> <span class="op">&lt;-</span> <span class="va">abstracts</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">abstracts</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Apply language detection to valid abstracts</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">valid_abstracts</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">languages</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">valid_abstracts</span>, <span class="va">detect_lang</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># View results</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    abstract_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">abstracts</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    language <span class="op">=</span> <span class="va">languages</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"No valid abstracts found for language detection"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         abstract_id</span></span>
<span><span class="co">#&gt; Sleep disorders are often associated with painful ones, especially in patients with chronic syndromes. Cephalgia occupies an important place among such algic forms as fibromyalgia, back pain, and abdominal and joint pain. Headaches and sleep disturbances may be independent, derived from a single pathogenetic factor, or their relationship may be bidirectional. This review focuses on the reciprocal relationship between headaches and sleep disorders; particular attention is paid to the morning headache variant associated with obstructive sleep apnea (OSA). Modern data on the anatomical structures and pathophysiological mechanisms common to disorders in the regulation of the sleep-wake cycle and the perception of pain impulses are presented. Possible pathogenetic processes and nuances of differential diagnosis of headaches associated with sleep apnea are discussed. Methods of treating headaches associated with sleep disorders, in particular OSA-associated cephalgia, are addressed. The effectiveness of therapy with constant positive airway pressure (CPAP therapy) and splint therapy for OSA has been shown for headaches associated with sleep apnea.                                                                                                                                                                                                                           1</span></span>
<span><span class="co">#&gt; Hemicrania continua is a rare and debilitating headache disorder characterized by continuous, unilateral pain that responds to indomethacin but is often resistant to other treatments. This report presents the case of a 26-year-old female patient with refractory hemicrania continua and chronic migraine who achieved significant pain relief following a fluoroscopy-guided third occipital nerve block and subsequent radiofrequency ablation (RFA) of the C2-C3 facet joint. The procedure resulted in an immediate reduction of pain as evident from a reduction in the Visual Analog Scale (VAS) score from 10/10 to 0/10, with sustained relief (VAS 2/10) at three months and notable improvement in the patient's quality of life. This case highlights the potential efficacy of targeting the third occipital nerve for the management of hemicrania continua, with thermal RFA (COOLIEF, Avanos Medical, Inc., Alpharetta, GA) offering prolonged relief by ablating nociceptive fibers. Given the emerging evidence supporting the involvement of the third occipital nerve in headache pathophysiology, the third occipital nerve block and RFA represent promising strategies for refractory cases.                                                                                                                                                                                                           2</span></span>
<span><span class="co">#&gt; Migraine is a heritable primary headache disorder which pathophysiology involves altered hypothalamic activity during migraine attacks. To explore the relationship between hypothalamic functional connectivity (HYPT FC) and genetic predisposition characterised by polygenic risk scores (PRS), in migraine, this research examines two types of PRS: one based on all migraine patients (PRSALL) regardless their time of diagnosis and other disorders, and another on "migraine-first" patients (PRSFIRST), whose first diagnosed condition was migraine in their lifetime. In an independent sample of 35 migraine patients and 38 healthy controls, using resting-state functional magnetic resonance (rfMRI, 3T) brain imaging, the study reveals significant hypoconnectivity of hypothalamus with the two investigated PRS scores but with different brain areas. While weakened hypothalamic connections in relations with PRSALL highlight regions involved in pain modulation, correlation with PRSFIRST emphasizes decreased connections with sensory and integrative brain areas, suggesting a link between migraine-first genetic risk and cortical hyperexcitability. Our results demonstrate that the polygenic risk of different migraine subgroups may advance our insight into the specific genetic and neural underpinnings of migraine, advancing precision medicine approaches in this field.           3</span></span>
<span><span class="co">#&gt; Like Janus, the Roman god of beginnings, transitions, and endings, spreading depolarizations (SDs) can be depicted with two faces: one looking backward, waving a symbolic farewell to the end of a cortical seizure; the other forward looking, opening a darker door for a fatal wave in the brainstem that ends life. There is good agreement on the distinct electrical nature of both events, but neither role is yet proven in patients. SD is a slow-moving wave of cellular depolarization that steadily silences neuronal networks and depresses EEG amplitude, whereas seizures represent fast, intermittent synchronization of neural networks with highly variable EEG activation patterns. However, the thresholds triggering both events are neither fixed nor inseparable; indeed, their co-occurrence and interaction depend on dimly-lit intrinsic brain pathophysiology. New insights into single gene control of SD and seizure thresholds are beginning to illuminate the darkness. Here, we review recent data and consider the title's question at the end.                                                                                                                                                                                                                                                                                                                                                 4</span></span>
<span><span class="co">#&gt; The article addresses the main mechanisms of migraine pathogenesis in terms of biochemical features (neurotransmitter metabolism, neurochemistry, neurophysiology, and neurogenetics). The effect of hormones, electrolytes (magnesium, calcium, sodium), vitamins (vitamin D, B12), and other biologically active molecules (melatonin, L-carnitine, L-tryptophan) on the course of the disease is considered. Including some laboratory tests in the migraine diagnostic algorithm helps identify the secondary nature of headache and/or dizziness, manage therapeutic approaches, and adjust the prognosis and treatment outcomes.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            5</span></span>
<span><span class="co">#&gt;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         language</span></span>
<span><span class="co">#&gt; Sleep disorders are often associated with painful ones, especially in patients with chronic syndromes. Cephalgia occupies an important place among such algic forms as fibromyalgia, back pain, and abdominal and joint pain. Headaches and sleep disturbances may be independent, derived from a single pathogenetic factor, or their relationship may be bidirectional. This review focuses on the reciprocal relationship between headaches and sleep disorders; particular attention is paid to the morning headache variant associated with obstructive sleep apnea (OSA). Modern data on the anatomical structures and pathophysiological mechanisms common to disorders in the regulation of the sleep-wake cycle and the perception of pain impulses are presented. Possible pathogenetic processes and nuances of differential diagnosis of headaches associated with sleep apnea are discussed. Methods of treating headaches associated with sleep disorders, in particular OSA-associated cephalgia, are addressed. The effectiveness of therapy with constant positive airway pressure (CPAP therapy) and splint therapy for OSA has been shown for headaches associated with sleep apnea.                                                                                                                                                                                                                       en</span></span>
<span><span class="co">#&gt; Hemicrania continua is a rare and debilitating headache disorder characterized by continuous, unilateral pain that responds to indomethacin but is often resistant to other treatments. This report presents the case of a 26-year-old female patient with refractory hemicrania continua and chronic migraine who achieved significant pain relief following a fluoroscopy-guided third occipital nerve block and subsequent radiofrequency ablation (RFA) of the C2-C3 facet joint. The procedure resulted in an immediate reduction of pain as evident from a reduction in the Visual Analog Scale (VAS) score from 10/10 to 0/10, with sustained relief (VAS 2/10) at three months and notable improvement in the patient's quality of life. This case highlights the potential efficacy of targeting the third occipital nerve for the management of hemicrania continua, with thermal RFA (COOLIEF, Avanos Medical, Inc., Alpharetta, GA) offering prolonged relief by ablating nociceptive fibers. Given the emerging evidence supporting the involvement of the third occipital nerve in headache pathophysiology, the third occipital nerve block and RFA represent promising strategies for refractory cases.                                                                                                                                                                                                       en</span></span>
<span><span class="co">#&gt; Migraine is a heritable primary headache disorder which pathophysiology involves altered hypothalamic activity during migraine attacks. To explore the relationship between hypothalamic functional connectivity (HYPT FC) and genetic predisposition characterised by polygenic risk scores (PRS), in migraine, this research examines two types of PRS: one based on all migraine patients (PRSALL) regardless their time of diagnosis and other disorders, and another on "migraine-first" patients (PRSFIRST), whose first diagnosed condition was migraine in their lifetime. In an independent sample of 35 migraine patients and 38 healthy controls, using resting-state functional magnetic resonance (rfMRI, 3T) brain imaging, the study reveals significant hypoconnectivity of hypothalamus with the two investigated PRS scores but with different brain areas. While weakened hypothalamic connections in relations with PRSALL highlight regions involved in pain modulation, correlation with PRSFIRST emphasizes decreased connections with sensory and integrative brain areas, suggesting a link between migraine-first genetic risk and cortical hyperexcitability. Our results demonstrate that the polygenic risk of different migraine subgroups may advance our insight into the specific genetic and neural underpinnings of migraine, advancing precision medicine approaches in this field.       en</span></span>
<span><span class="co">#&gt; Like Janus, the Roman god of beginnings, transitions, and endings, spreading depolarizations (SDs) can be depicted with two faces: one looking backward, waving a symbolic farewell to the end of a cortical seizure; the other forward looking, opening a darker door for a fatal wave in the brainstem that ends life. There is good agreement on the distinct electrical nature of both events, but neither role is yet proven in patients. SD is a slow-moving wave of cellular depolarization that steadily silences neuronal networks and depresses EEG amplitude, whereas seizures represent fast, intermittent synchronization of neural networks with highly variable EEG activation patterns. However, the thresholds triggering both events are neither fixed nor inseparable; indeed, their co-occurrence and interaction depend on dimly-lit intrinsic brain pathophysiology. New insights into single gene control of SD and seizure thresholds are beginning to illuminate the darkness. Here, we review recent data and consider the title's question at the end.                                                                                                                                                                                                                                                                                                                                             en</span></span>
<span><span class="co">#&gt; The article addresses the main mechanisms of migraine pathogenesis in terms of biochemical features (neurotransmitter metabolism, neurochemistry, neurophysiology, and neurogenetics). The effect of hormones, electrolytes (magnesium, calcium, sodium), vitamins (vitamin D, B12), and other biologically active molecules (melatonin, L-carnitine, L-tryptophan) on the course of the disease is considered. Including some laboratory tests in the migraine diagnostic algorithm helps identify the secondary nature of headache and/or dizziness, manage therapeutic approaches, and adjust the prognosis and treatment outcomes.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        en</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="entity-extraction">Entity Extraction<a class="anchor" aria-label="anchor" href="#entity-extraction"></a>
</h3>
<p>After preprocessing, the next step is to extract biomedical entities
from the text.</p>
<div class="section level4">
<h4 id="loading-entity-dictionaries">Loading Entity Dictionaries<a class="anchor" aria-label="anchor" href="#loading-entity-dictionaries"></a>
</h4>
<p>First, let’s load entity dictionaries that will be used for entity
recognition:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load a disease dictionary</span></span>
<span><span class="va">disease_dict</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/load_dictionary.html">load_dictionary</a></span><span class="op">(</span></span>
<span>  dictionary_type <span class="op">=</span> <span class="st">"disease"</span>,</span>
<span>  source <span class="op">=</span> <span class="st">"mesh"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Searching MeSH database for: disease[MeSH]</span></span>
<span><span class="co">#&gt; Found 193563 PubMed records with matching MeSH terms</span></span>
<span><span class="co">#&gt; Error getting MeSH links: Must specify either (not both) 'id' or 'web_history' arguments</span></span>
<span><span class="co">#&gt; Trying direct MeSH database search...</span></span>
<span><span class="co">#&gt; Processing batch 1 of 5</span></span>
<span><span class="co">#&gt; Extracted 20 unique terms from MeSH text format</span></span>
<span><span class="co">#&gt; Processing batch 2 of 5</span></span>
<span><span class="co">#&gt; Extracted 21 unique terms from MeSH text format</span></span>
<span><span class="co">#&gt; Processing batch 3 of 5</span></span>
<span><span class="co">#&gt; Extracted 25 unique terms from MeSH text format</span></span>
<span><span class="co">#&gt; Processing batch 4 of 5</span></span>
<span><span class="co">#&gt; Extracted 19 unique terms from MeSH text format</span></span>
<span><span class="co">#&gt; Processing batch 5 of 5</span></span>
<span><span class="co">#&gt; Extracted 21 unique terms from MeSH text format</span></span>
<span><span class="co">#&gt; Retrieved 102 unique terms from MeSH</span></span>
<span><span class="co">#&gt; Sanitizing dictionary with 102 terms...</span></span>
<span><span class="co">#&gt;   Removed 56 terms that did not match their claimed entity types</span></span>
<span><span class="co">#&gt;   Removed 38 terms with non-alphanumeric characters (final cleanup)</span></span>
<span><span class="co">#&gt; Sanitization complete. 8 terms remaining (7.8% of original)</span></span>
<span></span>
<span><span class="co"># Load a drug dictionary</span></span>
<span><span class="va">drug_dict</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/load_dictionary.html">load_dictionary</a></span><span class="op">(</span></span>
<span>  dictionary_type <span class="op">=</span> <span class="st">"drug"</span>,</span>
<span>  source <span class="op">=</span> <span class="st">"mesh"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Searching MeSH database for: pharmaceutical preparations[MeSH]</span></span>
<span><span class="co">#&gt; Found 985543 PubMed records with matching MeSH terms</span></span>
<span><span class="co">#&gt; Error getting MeSH links: Must specify either (not both) 'id' or 'web_history' arguments</span></span>
<span><span class="co">#&gt; Trying direct MeSH database search...</span></span>
<span><span class="co">#&gt; Processing batch 1 of 2</span></span>
<span><span class="co">#&gt; Extracted 23 unique terms from MeSH text format</span></span>
<span><span class="co">#&gt; Processing batch 2 of 2</span></span>
<span><span class="co">#&gt; Extracted 3 unique terms from MeSH text format</span></span>
<span><span class="co">#&gt; Retrieved 26 unique terms from MeSH</span></span>
<span><span class="co">#&gt; Sanitizing dictionary with 26 terms...</span></span>
<span><span class="co">#&gt;   Removed 26 terms that did not match their claimed entity types</span></span>
<span><span class="co">#&gt; Sanitization complete. 0 terms remaining (0% of original)</span></span>
<span></span>
<span><span class="co"># View a sample of each dictionary</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">disease_dict</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt;               term            id    type    source</span></span>
<span><span class="co">#&gt; 10     Lobomycosis       MESH_10 disease mesh_text</span></span>
<span><span class="co">#&gt; 20         Disease MESH_ENTRY_19 disease mesh_text</span></span>
<span><span class="co">#&gt; 48 Osteochondrosis        MESH_7 disease mesh_text</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">drug_dict</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] term   id     type   source</span></span>
<span><span class="co">#&gt; &lt;0 rows&gt; (or 0-length row.names)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="basic-entity-extraction">Basic Entity Extraction<a class="anchor" aria-label="anchor" href="#basic-entity-extraction"></a>
</h4>
<p>Now we can extract entities from the text using these
dictionaries:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract disease and drug entities</span></span>
<span><span class="va">entities</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_entities.html">extract_entities</a></span><span class="op">(</span></span>
<span>  <span class="va">preprocessed_data</span>,</span>
<span>  text_column <span class="op">=</span> <span class="st">"abstract"</span>,</span>
<span>  dictionary <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">disease_dict</span>, <span class="va">drug_dict</span><span class="op">)</span>,</span>
<span>  case_sensitive <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  overlap_strategy <span class="op">=</span> <span class="st">"priority"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Sanitizing dictionary with 8 terms...</span></span>
<span><span class="co">#&gt; Sanitization complete. 8 terms remaining (100% of original)</span></span>
<span><span class="co">#&gt; Extracting entities from 98 documents...</span></span>
<span><span class="co">#&gt; Extracted 36 entity mentions:</span></span>
<span><span class="co">#&gt;   disease: 36</span></span>
<span></span>
<span><span class="co"># View some extracted entities</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">entities</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"doc_id"</span>, <span class="st">"entity"</span>, <span class="st">"entity_type"</span>, <span class="st">"sentence"</span><span class="op">)</span><span class="op">]</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt;    doc_id  entity entity_type</span></span>
<span><span class="co">#&gt; 1       5 Disease     disease</span></span>
<span><span class="co">#&gt; 2      10 Disease     disease</span></span>
<span><span class="co">#&gt; 3      22 Disease     disease</span></span>
<span><span class="co">#&gt; 4      22 Disease     disease</span></span>
<span><span class="co">#&gt; 5      31 Disease     disease</span></span>
<span><span class="co">#&gt; 6      41 Disease     disease</span></span>
<span><span class="co">#&gt; 7      44 Disease     disease</span></span>
<span><span class="co">#&gt; 8      45 Disease     disease</span></span>
<span><span class="co">#&gt; 9      47 Disease     disease</span></span>
<span><span class="co">#&gt; 10     54 Disease     disease</span></span>
<span><span class="co">#&gt;                                                                                                                                                                                                                                 sentence</span></span>
<span><span class="co">#&gt; 1               The effect of hormones, electrolytes (magnesium, calcium, sodium), vitamins (vitamin D, B12), and other biologically active molecules (melatonin, L-carnitine, L-tryptophan) on the course of the disease is considered.</span></span>
<span><span class="co">#&gt; 2                                                The the prevalence of aura (p = 0.028), age (p = 0.001) and mean disease duration (p &lt; 0.001, t=-4.257) were significantly higher in migraine patients with WMH than those without WMH.</span></span>
<span><span class="co">#&gt; 3                                                                                                                                                       Neuroimaging has contributed to a better understanding of VSS disease mechanism.</span></span>
<span><span class="co">#&gt; 4                                                                                       Given the complexity of its disease state, multidisciplinary therapeutic approaches appear to be required for more effective symptom management.</span></span>
<span><span class="co">#&gt; 5                                                                                 Ménière's disease (4%) and vestibular neuritis/labyrinthitis (3.9%) were associated with younger patients and unilateral or asymmetrical hearing loss.</span></span>
<span><span class="co">#&gt; 6  Therefore, although migraine with and without aura are considered two types of the same disease, more research should focus on their differences, thus finally enabling better specific treatment options for both types of migraine.</span></span>
<span><span class="co">#&gt; 7                                                                                                                                                      Common comorbidities were hypertension, diabetes, and polycystic ovarian disease.</span></span>
<span><span class="co">#&gt; 8                                                             CONCLUSIONS: Our study shows that UFs share substantial genetic basis with traits related to BP, obesity, diabetes, and migraine, a predominantly female vascular disease.</span></span>
<span><span class="co">#&gt; 9                  BACKGROUND: Coronavirus disease 2019 (COVID-19), caused by the SARS-CoV-2 virus, placed unprecedented pressure on public health systems due to its mortality and global panic-and later due to long COVID challenges.</span></span>
<span><span class="co">#&gt; 10                        Central nervous system (CNS) disorders, such as Alzheimer's disease (AD), Parkinson's disease (PD), multiple sclerosis (MS), and migraines, rank among the most prevalent and concerning conditions worldwide.</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="complete-entity-extraction-workflow">Complete Entity Extraction Workflow<a class="anchor" aria-label="anchor" href="#complete-entity-extraction-workflow"></a>
</h4>
<p>For a more comprehensive approach, we can use the complete entity
extraction workflow:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract entities using the complete workflow</span></span>
<span><span class="co"># Check if running in R CMD check environment</span></span>
<span><span class="va">is_check</span> <span class="op">&lt;-</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span> <span class="op">&amp;&amp;</span> </span>
<span>            <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"R_CHECK_RUNNING"</span><span class="op">)</span><span class="op">)</span> <span class="op">&amp;&amp;</span> </span>
<span>             <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"R_CHECK_RUNNING"</span><span class="op">)</span> <span class="op">==</span> <span class="st">"true"</span><span class="op">)</span></span>
<span>             </span>
<span><span class="co"># More robust check for testing environment</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="va">is_check</span> <span class="op">&amp;&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"_R_CHECK_LIMIT_CORES_"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">is_check</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Set number of cores based on environment</span></span>
<span><span class="va">num_cores_to_use</span> <span class="op">&lt;-</span> <span class="kw">if</span><span class="op">(</span><span class="va">is_check</span><span class="op">)</span> <span class="fl">1</span> <span class="kw">else</span> <span class="fl">4</span></span>
<span></span>
<span><span class="co"># Extract entities using the complete workflow</span></span>
<span><span class="va">entities_workflow</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_entities_workflow.html">extract_entities_workflow</a></span><span class="op">(</span></span>
<span>  <span class="va">preprocessed_data</span>,</span>
<span>  text_column <span class="op">=</span> <span class="st">"abstract"</span>,</span>
<span>  entity_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"disease"</span>, <span class="st">"drug"</span>, <span class="st">"gene"</span>, <span class="st">"protein"</span>, <span class="st">"pathway"</span><span class="op">)</span>,</span>
<span>  dictionary_sources <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"local"</span>, <span class="st">"mesh"</span><span class="op">)</span>,</span>
<span>  sanitize <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  parallel <span class="op">=</span> <span class="op">!</span><span class="va">is_check</span>,           <span class="co"># Disable parallel in check environment</span></span>
<span>  num_cores <span class="op">=</span> <span class="va">num_cores_to_use</span>    <span class="co"># Use 1 core in check environment</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Running in R CMD check environment. Disabling parallel processing.</span></span>
<span><span class="co">#&gt; Creating dictionaries for entity extraction...</span></span>
<span><span class="co">#&gt; Loading dictionaries sequentially...</span></span>
<span><span class="co">#&gt; Package not installed or dictionary not found. Using example dictionaries.</span></span>
<span><span class="co">#&gt; Creating dummy dictionary for disease</span></span>
<span><span class="co">#&gt;   Added 20 terms from disease (local)</span></span>
<span><span class="co">#&gt; Package not installed or dictionary not found. Using example dictionaries.</span></span>
<span><span class="co">#&gt; Creating dummy dictionary for drug</span></span>
<span><span class="co">#&gt;   Added 20 terms from drug (local)</span></span>
<span><span class="co">#&gt; Package not installed or dictionary not found. Using example dictionaries.</span></span>
<span><span class="co">#&gt; Creating dummy dictionary for gene</span></span>
<span><span class="co">#&gt;   Added 20 terms from gene (local)</span></span>
<span><span class="co">#&gt; Searching MeSH database for: proteins[MeSH]</span></span>
<span><span class="co">#&gt; Found 7579035 PubMed records with matching MeSH terms</span></span>
<span><span class="co">#&gt; Error getting MeSH links: Must specify either (not both) 'id' or 'web_history' arguments</span></span>
<span><span class="co">#&gt; Trying direct MeSH database search...</span></span>
<span><span class="co">#&gt; Processing batch 1 of 5</span></span>
<span><span class="co">#&gt; Extracted 24 unique terms from MeSH text format</span></span>
<span><span class="co">#&gt; Processing batch 2 of 5</span></span>
<span><span class="co">#&gt; Extracted 23 unique terms from MeSH text format</span></span>
<span><span class="co">#&gt; Processing batch 3 of 5</span></span>
<span><span class="co">#&gt; Extracted 19 unique terms from MeSH text format</span></span>
<span><span class="co">#&gt; Processing batch 4 of 5</span></span>
<span><span class="co">#&gt; Extracted 20 unique terms from MeSH text format</span></span>
<span><span class="co">#&gt; Processing batch 5 of 5</span></span>
<span><span class="co">#&gt; Extracted 19 unique terms from MeSH text format</span></span>
<span><span class="co">#&gt; Retrieved 105 unique terms from MeSH</span></span>
<span><span class="co">#&gt;   Added 105 terms from protein (mesh)</span></span>
<span><span class="co">#&gt; Searching MeSH database for: metabolic networks and pathways[MeSH]</span></span>
<span><span class="co">#&gt; Found 184983 PubMed records with matching MeSH terms</span></span>
<span><span class="co">#&gt; Error getting MeSH links: Must specify either (not both) 'id' or 'web_history' arguments</span></span>
<span><span class="co">#&gt; Trying direct MeSH database search...</span></span>
<span><span class="co">#&gt; Processing batch 1 of 1</span></span>
<span><span class="co">#&gt; Extracted 6 unique terms from MeSH text format</span></span>
<span><span class="co">#&gt; Retrieved 6 unique terms from MeSH</span></span>
<span><span class="co">#&gt;   Added 6 terms from pathway (mesh)</span></span>
<span><span class="co">#&gt; Created combined dictionary with 171 unique terms</span></span>
<span><span class="co">#&gt; Sanitizing dictionary with 171 terms...</span></span>
<span><span class="co">#&gt;   Removed 8 terms with numbers followed by special characters</span></span>
<span><span class="co">#&gt;   Correcting type for 'headache' from 'disease' to 'symptom'</span></span>
<span><span class="co">#&gt;   Correcting type for 'fatigue' from 'disease' to 'symptom'</span></span>
<span><span class="co">#&gt;   Applied 2 type corrections for commonly misclassified terms</span></span>
<span><span class="co">#&gt;   Removed 107 terms that did not match their claimed entity types</span></span>
<span><span class="co">#&gt;   Removed 42 terms with non-alphanumeric characters (final cleanup)</span></span>
<span><span class="co">#&gt; Sanitization complete. 14 terms remaining (8.2% of original)</span></span>
<span><span class="co">#&gt; Extracting entities from 98 documents...</span></span>
<span><span class="co">#&gt; Processing batch 1/1</span></span>
<span><span class="co">#&gt; Extracting entities from 98 documents...</span></span>
<span><span class="co">#&gt; Extracted 662 entity mentions:</span></span>
<span><span class="co">#&gt;   disease: 533</span></span>
<span><span class="co">#&gt;   protein: 13</span></span>
<span><span class="co">#&gt;   symptom: 116</span></span>
<span><span class="co">#&gt; Extracted 662 entity mentions in 0.13 minutes</span></span>
<span><span class="co">#&gt;   disease: 533</span></span>
<span><span class="co">#&gt;   protein: 13</span></span>
<span><span class="co">#&gt;   symptom: 116</span></span>
<span></span>
<span><span class="co"># View summary of entity types</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">entities_workflow</span><span class="op">$</span><span class="va">entity_type</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; disease protein symptom </span></span>
<span><span class="co">#&gt;     533      13     116</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="customizing-entity-extraction">Customizing Entity Extraction<a class="anchor" aria-label="anchor" href="#customizing-entity-extraction"></a>
</h4>
<p>We can customize the entity extraction process by providing
additional MeSH queries or custom dictionaries:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define custom MeSH queries for different entity types</span></span>
<span><span class="va">mesh_queries</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"disease"</span> <span class="op">=</span> <span class="st">"migraine disorders[MeSH] OR headache disorders[MeSH]"</span>,</span>
<span>  <span class="st">"drug"</span> <span class="op">=</span> <span class="st">"analgesics[MeSH] OR serotonin agonists[MeSH] OR anticonvulsants[MeSH]"</span>,</span>
<span>  <span class="st">"gene"</span> <span class="op">=</span> <span class="st">"genes[MeSH] OR channelopathy[MeSH]"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a custom dictionary</span></span>
<span><span class="va">custom_dict</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  term <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CGRP"</span>, <span class="st">"trigeminal nerve"</span>, <span class="st">"cortical spreading depression"</span><span class="op">)</span>,</span>
<span>  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"protein"</span>, <span class="st">"anatomy"</span>, <span class="st">"biological_process"</span><span class="op">)</span>,</span>
<span>  id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CUSTOM_1"</span>, <span class="st">"CUSTOM_2"</span>, <span class="st">"CUSTOM_3"</span><span class="op">)</span>,</span>
<span>  source <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"custom"</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract entities with custom settings</span></span>
<span><span class="va">custom_entities</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_entities_workflow.html">extract_entities_workflow</a></span><span class="op">(</span></span>
<span>  <span class="va">preprocessed_data</span>,</span>
<span>  text_column <span class="op">=</span> <span class="st">"abstract"</span>,</span>
<span>  entity_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"disease"</span>, <span class="st">"drug"</span>, <span class="st">"gene"</span>, <span class="st">"protein"</span>, <span class="st">"pathway"</span><span class="op">)</span>,</span>
<span>  dictionary_sources <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"local"</span>, <span class="st">"mesh"</span><span class="op">)</span>,</span>
<span>  additional_mesh_queries <span class="op">=</span> <span class="va">mesh_queries</span>,</span>
<span>  custom_dictionary <span class="op">=</span> <span class="va">custom_dict</span>,</span>
<span>  sanitize <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Running in R CMD check environment. Disabling parallel processing.</span></span>
<span><span class="co">#&gt; Creating dictionaries for entity extraction...</span></span>
<span><span class="co">#&gt; Adding 3 terms from custom dictionary</span></span>
<span><span class="co">#&gt; Loading dictionaries sequentially...</span></span>
<span><span class="co">#&gt;   Using cached dictionary for disease (local)</span></span>
<span><span class="co">#&gt;   Using cached dictionary for drug (local)</span></span>
<span><span class="co">#&gt;   Using cached dictionary for gene (local)</span></span>
<span><span class="co">#&gt;   Using cached dictionary for protein (mesh)</span></span>
<span><span class="co">#&gt;   Using cached dictionary for pathway (mesh)</span></span>
<span><span class="co">#&gt; Created combined dictionary with 174 unique terms</span></span>
<span><span class="co">#&gt; Sanitizing dictionary with 171 terms...</span></span>
<span><span class="co">#&gt;   Removed 8 terms with numbers followed by special characters</span></span>
<span><span class="co">#&gt;   Correcting type for 'headache' from 'disease' to 'symptom'</span></span>
<span><span class="co">#&gt;   Correcting type for 'fatigue' from 'disease' to 'symptom'</span></span>
<span><span class="co">#&gt;   Applied 2 type corrections for commonly misclassified terms</span></span>
<span><span class="co">#&gt;   Removed 107 terms that did not match their claimed entity types</span></span>
<span><span class="co">#&gt;   Removed 42 terms with non-alphanumeric characters (final cleanup)</span></span>
<span><span class="co">#&gt; Sanitization complete. 14 terms remaining (8.2% of original)</span></span>
<span><span class="co">#&gt; Extracting entities from 98 documents...</span></span>
<span><span class="co">#&gt; Processing batch 1/1</span></span>
<span><span class="co">#&gt; Extracting entities from 98 documents...</span></span>
<span><span class="co">#&gt; Extracted 736 entity mentions:</span></span>
<span><span class="co">#&gt;   anatomy: 2</span></span>
<span><span class="co">#&gt;   biological_process: 8</span></span>
<span><span class="co">#&gt;   disease: 533</span></span>
<span><span class="co">#&gt;   protein: 77</span></span>
<span><span class="co">#&gt;   symptom: 116</span></span>
<span><span class="co">#&gt; Extracted 736 entity mentions in 0.01 minutes</span></span>
<span><span class="co">#&gt;   anatomy: 2</span></span>
<span><span class="co">#&gt;   biological_process: 8</span></span>
<span><span class="co">#&gt;   disease: 533</span></span>
<span><span class="co">#&gt;   protein: 77</span></span>
<span><span class="co">#&gt;   symptom: 116</span></span>
<span></span>
<span><span class="co"># View custom entities</span></span>
<span><span class="va">custom_entities</span><span class="op">[</span><span class="va">custom_entities</span><span class="op">$</span><span class="va">source</span> <span class="op">==</span> <span class="st">"custom"</span>, <span class="op">]</span></span>
<span><span class="co">#&gt; [1] entity      entity_type doc_id      start_pos   end_pos     sentence   </span></span>
<span><span class="co">#&gt; [7] frequency  </span></span>
<span><span class="co">#&gt; &lt;0 rows&gt; (or 0-length row.names)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="dictionary-sanitization">Dictionary Sanitization<a class="anchor" aria-label="anchor" href="#dictionary-sanitization"></a>
</h3>
<p>The quality of entity extraction heavily depends on the quality of
the dictionaries. We can sanitize dictionaries to improve extraction
quality:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a raw dictionary with some problematic entries</span></span>
<span><span class="va">raw_dict</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  term <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"migraine"</span>, <span class="st">"5-HT"</span>, <span class="st">"headache"</span>, <span class="st">"the"</span>, <span class="st">"and"</span>, <span class="st">"patient"</span>, <span class="st">"inflammation"</span>, <span class="st">"study"</span><span class="op">)</span>,</span>
<span>  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"disease"</span>, <span class="st">"chemical"</span>, <span class="st">"symptom"</span>, <span class="st">"NA"</span>, <span class="st">"NA"</span>, <span class="st">"NA"</span>, <span class="st">"biological_process"</span>, <span class="st">"NA"</span><span class="op">)</span>,</span>
<span>  id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"ID_"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span>,</span>
<span>  source <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"example"</span>, <span class="fl">8</span><span class="op">)</span>,</span>
<span>  stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Sanitize the dictionary</span></span>
<span><span class="va">sanitized_dict</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sanitize_dictionary.html">sanitize_dictionary</a></span><span class="op">(</span></span>
<span>  <span class="va">raw_dict</span>,</span>
<span>  term_column <span class="op">=</span> <span class="st">"term"</span>,</span>
<span>  type_column <span class="op">=</span> <span class="st">"type"</span>,</span>
<span>  validate_types <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Sanitizing dictionary with 8 terms...</span></span>
<span><span class="co">#&gt;   Removed 1 terms with numbers followed by special characters</span></span>
<span><span class="co">#&gt;   Removed 1 common non-medical terms, conjunctive adverbs, and general terms</span></span>
<span><span class="co">#&gt; Sanitization complete. 6 terms remaining (75% of original)</span></span>
<span></span>
<span><span class="co"># View the sanitized dictionary</span></span>
<span><span class="va">sanitized_dict</span></span>
<span><span class="co">#&gt;           term               type   id  source</span></span>
<span><span class="co">#&gt; 1     migraine            disease ID_1 example</span></span>
<span><span class="co">#&gt; 3     headache            symptom ID_3 example</span></span>
<span><span class="co">#&gt; 4          the                 NA ID_4 example</span></span>
<span><span class="co">#&gt; 5          and                 NA ID_5 example</span></span>
<span><span class="co">#&gt; 7 inflammation biological_process ID_7 example</span></span>
<span><span class="co">#&gt; 8        study                 NA ID_8 example</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="mapping-terms-to-biomedical-ontologies">Mapping Terms to Biomedical Ontologies<a class="anchor" aria-label="anchor" href="#mapping-terms-to-biomedical-ontologies"></a>
</h3>
<p>We can map extracted terms to standard biomedical ontologies like
MeSH or UMLS:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract terms to map</span></span>
<span><span class="va">terms_to_map</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"migraine"</span>, <span class="st">"headache"</span>, <span class="st">"CGRP"</span>, <span class="st">"serotonin"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Map to MeSH</span></span>
<span><span class="va">mesh_mappings</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/map_ontology.html">map_ontology</a></span><span class="op">(</span></span>
<span>  <span class="va">terms_to_map</span>,</span>
<span>  ontology <span class="op">=</span> <span class="st">"mesh"</span>,</span>
<span>  fuzzy_match <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  similarity_threshold <span class="op">=</span> <span class="fl">0.8</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Searching MeSH database for: disease[MeSH]</span></span>
<span><span class="co">#&gt; Found 193563 PubMed records with matching MeSH terms</span></span>
<span><span class="co">#&gt; Error getting MeSH links: Must specify either (not both) 'id' or 'web_history' arguments</span></span>
<span><span class="co">#&gt; Trying direct MeSH database search...</span></span>
<span><span class="co">#&gt; Processing batch 1 of 5</span></span>
<span><span class="co">#&gt; Extracted 20 unique terms from MeSH text format</span></span>
<span><span class="co">#&gt; Processing batch 2 of 5</span></span>
<span><span class="co">#&gt; Extracted 21 unique terms from MeSH text format</span></span>
<span><span class="co">#&gt; Processing batch 3 of 5</span></span>
<span><span class="co">#&gt; Extracted 25 unique terms from MeSH text format</span></span>
<span><span class="co">#&gt; Processing batch 4 of 5</span></span>
<span><span class="co">#&gt; Extracted 19 unique terms from MeSH text format</span></span>
<span><span class="co">#&gt; Processing batch 5 of 5</span></span>
<span><span class="co">#&gt; Extracted 21 unique terms from MeSH text format</span></span>
<span><span class="co">#&gt; Retrieved 102 unique terms from MeSH</span></span>
<span><span class="co">#&gt; Sanitizing dictionary with 102 terms...</span></span>
<span><span class="co">#&gt;   Removed 56 terms that did not match their claimed entity types</span></span>
<span><span class="co">#&gt;   Removed 38 terms with non-alphanumeric characters (final cleanup)</span></span>
<span><span class="co">#&gt; Sanitization complete. 8 terms remaining (7.8% of original)</span></span>
<span><span class="co">#&gt; No matches found for the input terms in the mesh ontology</span></span>
<span></span>
<span><span class="co"># View MeSH mappings</span></span>
<span><span class="va">mesh_mappings</span></span>
<span><span class="co">#&gt; [1] term          ontology_id   ontology_term match_type   </span></span>
<span><span class="co">#&gt; &lt;0 rows&gt; (or 0-length row.names)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="topic-modeling">Topic Modeling<a class="anchor" aria-label="anchor" href="#topic-modeling"></a>
</h3>
<p>We can also apply topic modeling to discover the main themes in the
corpus:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract topics from the corpus</span></span>
<span><span class="va">topics</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_topics.html">extract_topics</a></span><span class="op">(</span></span>
<span>  <span class="va">migraine_articles</span>,</span>
<span>  text_column <span class="op">=</span> <span class="st">"abstract"</span>,</span>
<span>  n_topics <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  max_terms <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Tokenizing text...</span></span>
<span></span>
<span><span class="co"># View top terms for each topic</span></span>
<span><span class="va">topics</span><span class="op">$</span><span class="va">topics</span></span>
<span><span class="co">#&gt; $`Topic 1`</span></span>
<span><span class="co">#&gt;                term    weight</span></span>
<span><span class="co">#&gt; migraine   migraine 158.54694</span></span>
<span><span class="co">#&gt; cgrp           cgrp  33.93941</span></span>
<span><span class="co">#&gt; aura           aura  28.48012</span></span>
<span><span class="co">#&gt; headache   headache  26.85610</span></span>
<span><span class="co">#&gt; pain           pain  26.52241</span></span>
<span><span class="co">#&gt; between     between  23.21742</span></span>
<span><span class="co">#&gt; patients   patients  20.81965</span></span>
<span><span class="co">#&gt; study         study  20.37030</span></span>
<span><span class="co">#&gt; related     related  20.09579</span></span>
<span><span class="co">#&gt; treatment treatment  19.25877</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`Topic 2`</span></span>
<span><span class="co">#&gt;                    term    weight</span></span>
<span><span class="co">#&gt; progression progression 37.439073</span></span>
<span><span class="co">#&gt; migraine       migraine 36.013245</span></span>
<span><span class="co">#&gt; 634                 634 10.570779</span></span>
<span><span class="co">#&gt; definitions definitions 10.570779</span></span>
<span><span class="co">#&gt; midas             midas  9.241191</span></span>
<span><span class="co">#&gt; mhd                 mhd  8.808983</span></span>
<span><span class="co">#&gt; increase       increase  7.308507</span></span>
<span><span class="co">#&gt; odds               odds  7.052829</span></span>
<span><span class="co">#&gt; year               year  7.047243</span></span>
<span><span class="co">#&gt; definition   definition  7.047186</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`Topic 3`</span></span>
<span><span class="co">#&gt;                    term   weight</span></span>
<span><span class="co">#&gt; patients       patients 44.09683</span></span>
<span><span class="co">#&gt; brain             brain 40.43149</span></span>
<span><span class="co">#&gt; asd                 asd 39.81409</span></span>
<span><span class="co">#&gt; mwoa               mwoa 39.58473</span></span>
<span><span class="co">#&gt; stroke           stroke 34.74475</span></span>
<span><span class="co">#&gt; after             after 31.86060</span></span>
<span><span class="co">#&gt; network         network 29.71455</span></span>
<span><span class="co">#&gt; significant significant 28.73627</span></span>
<span><span class="co">#&gt; compared       compared 26.71239</span></span>
<span><span class="co">#&gt; individuals individuals 25.19733</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`Topic 4`</span></span>
<span><span class="co">#&gt;                    term   weight</span></span>
<span><span class="co">#&gt; migraine       migraine 73.11895</span></span>
<span><span class="co">#&gt; covid             covid 60.29671</span></span>
<span><span class="co">#&gt; patients       patients 48.10263</span></span>
<span><span class="co">#&gt; long               long 33.81408</span></span>
<span><span class="co">#&gt; individuals individuals 31.86965</span></span>
<span><span class="co">#&gt; headache       headache 27.79943</span></span>
<span><span class="co">#&gt; symptoms       symptoms 25.11927</span></span>
<span><span class="co">#&gt; without         without 20.33448</span></span>
<span><span class="co">#&gt; sex                 sex 15.35365</span></span>
<span><span class="co">#&gt; study             study 15.23040</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`Topic 5`</span></span>
<span><span class="co">#&gt;                      term   weight</span></span>
<span><span class="co">#&gt; migraine         migraine 78.23895</span></span>
<span><span class="co">#&gt; group               group 28.04809</span></span>
<span><span class="co">#&gt; patients         patients 24.72097</span></span>
<span><span class="co">#&gt; study               study 16.40871</span></span>
<span><span class="co">#&gt; between           between 15.56503</span></span>
<span><span class="co">#&gt; edema               edema 11.28163</span></span>
<span><span class="co">#&gt; perilesional perilesional 11.28163</span></span>
<span><span class="co">#&gt; days                 days 11.08811</span></span>
<span><span class="co">#&gt; scores             scores 10.27279</span></span>
<span><span class="co">#&gt; compared         compared 10.20141</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Chao Liu.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
